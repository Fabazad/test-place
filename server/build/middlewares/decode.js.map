{"version":3,"file":"decode.js","sources":["middlewares/decode.ts"],"sourceRoot":"/","sourcesContent":["import { getAuthManager } from \"@/libs/AuthManager/index.js\";\nimport { NextFunction, Request, Response } from \"express\";\n\nexport const decode = (req: Request, res: Response, next: NextFunction) => {\n  const token =\n    (req.body && req.body.token) ||\n    (req.query && req.query.token) ||\n    req.headers[\"x-access-token\"] ||\n    (req.cookies && req.cookies.token);\n  if (typeof token !== \"string\") {\n    return next();\n  }\n  try {\n    const authManager = getAuthManager();\n    const decoded = authManager.decodeUser(token);\n    if (decoded) {\n      req.decoded = decoded;\n    }\n    return next();\n  } catch (err) {\n    return next();\n  }\n};\n"],"names":[],"mappings":";;AAAA,OAAO,EAAE,cAAc,EAAE,MAAM,6BAA6B,CAAC;AAG7D,MAAM,CAAC,MAAM,MAAM,GAAG,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACxE,MAAM,KAAK,GACT,CAAC,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;QAC5B,CAAC,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC;QAC9B,GAAG,CAAC,OAAO,CAAC,gBAAgB,CAAC;QAC7B,CAAC,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IACrC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,OAAO,IAAI,EAAE,CAAC;IAChB,CAAC;IACD,IAAI,CAAC;QACH,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;QACrC,MAAM,OAAO,GAAG,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QAC9C,IAAI,OAAO,EAAE,CAAC;YACZ,GAAG,CAAC,OAAO,GAAG,OAAO,CAAC;QACxB,CAAC;QACD,OAAO,IAAI,EAAE,CAAC;IAChB,CAAC;IAAC,OAAO,GAAG,EAAE,CAAC;QACb,OAAO,IAAI,EAAE,CAAC;IAChB,CAAC;AACH,CAAC,CAAC","debug_id":"4a058696-f841-5605-aedb-aac60c21bc8b"}