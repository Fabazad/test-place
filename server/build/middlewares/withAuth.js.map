{"version":3,"file":"withAuth.js","sources":["middlewares/withAuth.ts"],"sourceRoot":"/","sourcesContent":["import { getAuthManager } from \"@/libs/AuthManager/index.js\";\nimport { Role } from \"@/utils/constants.js\";\nimport { NextFunction, Request, Response } from \"express\";\n\nexport const withAuth =\n  (role: Role | null = null) =>\n  (req: Request, res: Response, next: NextFunction) => {\n    if (!req.decoded) return res.status(401).send(\"Unauthorized\");\n    if (role === null) return next();\n\n    const authManager = getAuthManager();\n\n    if (authManager.checkRole(role, req.decoded)) {\n      return next();\n    }\n    return res.status(401).send(\"Unauthorized\");\n  };\n"],"names":[],"mappings":";;AAAA,OAAO,EAAE,cAAc,EAAE,MAAM,6BAA6B,CAAC;AAI7D,MAAM,CAAC,MAAM,QAAQ,GACnB,CAAC,OAAoB,IAAI,EAAE,EAAE,CAC7B,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAClD,IAAI,CAAC,GAAG,CAAC,OAAO;QAAE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IAC9D,IAAI,IAAI,KAAK,IAAI;QAAE,OAAO,IAAI,EAAE,CAAC;IAEjC,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;IAErC,IAAI,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC;QAC7C,OAAO,IAAI,EAAE,CAAC;IAChB,CAAC;IACD,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAC9C,CAAC,CAAC","debug_id":"ff42f7e5-ca86-5dc6-9a5e-602981316d44"}