{"version":3,"file":"emailLastPublishedProducts.cli.js","sources":["cli/emailLastPublishedProducts.cli.ts"],"sourceRoot":"/","sourcesContent":["import { configs } from \"@/configs.js\";\nimport { ProductController } from \"@/controllers/product.controller.js\";\nimport { getMonitoringClient } from \"@/libs/MonitoringClient/index.js\";\nimport { getDatabaseConnection } from \"databaseConnection/index.js\";\nimport dayjs from \"dayjs\";\n\nconst emailLastPublishedProducts = async () => {\n  if (dayjs().day() !== 0) {\n    console.log(\"This script should be run on Sunday\");\n    process.exit(0);\n  }\n\n  const monitoringClient = getMonitoringClient();\n  const databaseConnection = getDatabaseConnection();\n\n  try {\n    await databaseConnection.connect();\n    await ProductController.emailLastPublishedProducts({\n      frontendUrl: configs.FRONTEND_URL,\n      lastPublishedProductsPeriodInDays: configs.LAST_PUBLISHED_PRODUCTS_PERIOD_IN_DAYS,\n      productsLimit: configs.PRODUCTS_LIMIT_ON_LAST_PUBLISHED,\n    });\n  } catch (err: any) {\n    monitoringClient.sendEvent({\n      level: \"error\",\n      eventName: \"email_last_published_products\",\n      data: {\n        message: err.message,\n      },\n    });\n  }\n\n  await databaseConnection.disconnect();\n  process.exit(0);\n};\n\nemailLastPublishedProducts();\n"],"names":[],"mappings":";;AAAA,OAAO,EAAE,OAAO,EAAE,MAAM,cAAc,CAAC;AACvC,OAAO,EAAE,iBAAiB,EAAE,MAAM,qCAAqC,CAAC;AACxE,OAAO,EAAE,mBAAmB,EAAE,MAAM,kCAAkC,CAAC;AACvE,OAAO,EAAE,qBAAqB,EAAE,MAAM,6BAA6B,CAAC;AACpE,OAAO,KAAK,MAAM,OAAO,CAAC;AAE1B,MAAM,0BAA0B,GAAG,KAAK,IAAI,EAAE;IAC5C,IAAI,KAAK,EAAE,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,CAAC;QACxB,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;QACnD,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC;IAED,MAAM,gBAAgB,GAAG,mBAAmB,EAAE,CAAC;IAC/C,MAAM,kBAAkB,GAAG,qBAAqB,EAAE,CAAC;IAEnD,IAAI,CAAC;QACH,MAAM,kBAAkB,CAAC,OAAO,EAAE,CAAC;QACnC,MAAM,iBAAiB,CAAC,0BAA0B,CAAC;YACjD,WAAW,EAAE,OAAO,CAAC,YAAY;YACjC,iCAAiC,EAAE,OAAO,CAAC,sCAAsC;YACjF,aAAa,EAAE,OAAO,CAAC,gCAAgC;SACxD,CAAC,CAAC;IACL,CAAC;IAAC,OAAO,GAAQ,EAAE,CAAC;QAClB,gBAAgB,CAAC,SAAS,CAAC;YACzB,KAAK,EAAE,OAAO;YACd,SAAS,EAAE,+BAA+B;YAC1C,IAAI,EAAE;gBACJ,OAAO,EAAE,GAAG,CAAC,OAAO;aACrB;SACF,CAAC,CAAC;IACL,CAAC;IAED,MAAM,kBAAkB,CAAC,UAAU,EAAE,CAAC;IACtC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAClB,CAAC,CAAC;AAEF,0BAA0B,EAAE,CAAC","debug_id":"34b3a229-17b4-5955-854e-d00273daf101"}