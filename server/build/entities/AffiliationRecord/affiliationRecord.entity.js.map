{"version":3,"file":"affiliationRecord.entity.js","sources":["entities/AffiliationRecord/affiliationRecord.entity.ts"],"sourceRoot":"/","sourcesContent":["import { InferEnum } from \"@/utils/inferEnum.js\";\nimport { savedDataSchema } from \"@/utils/savedDataSchema.js\";\nimport { User } from \"@sentry/node\";\nimport z from \"zod\";\n\nexport const AffiliationRecordParamsType = {\n  AFFILIATED_COMMISSION: \"affiliatedCommission\",\n  APP_PAYMENT: \"appPayment\",\n} as const;\n\nexport type AffiliationRecordParamsType = InferEnum<typeof AffiliationRecordParamsType>;\n\nconst affiliatedCommissionParamsSchema = z.object({\n  paramsType: z.literal(AffiliationRecordParamsType.AFFILIATED_COMMISSION),\n  affiliated: z.string({ description: \"User\" }),\n  rateInPercent: z.number(),\n});\n\nconst appPaymentParamsSchema = z.object({\n  paramsType: z.literal(AffiliationRecordParamsType.APP_PAYMENT),\n});\n\nexport const affiliationRecordDataSchema = z.object({\n  amount: z.number(),\n  ambassadorId: z.string({ description: \"User\" }),\n  params: z.discriminatedUnion(\"paramsType\", [\n    affiliatedCommissionParamsSchema,\n    appPaymentParamsSchema,\n  ]),\n});\n\nexport type AffiliationRecordData = z.infer<typeof affiliationRecordDataSchema>;\n\nexport const affiliationRecordSchema =\n  affiliationRecordDataSchema.extend(savedDataSchema);\n\ntype AffiliatedCommissionParams<Affiliated = string> = Omit<\n  z.infer<typeof affiliatedCommissionParamsSchema>,\n  \"affiliated\"\n> & { affiliated: Affiliated };\n\ntype AppPaymentParams = z.infer<typeof appPaymentParamsSchema>;\n\nexport type AffiliationRecord<Affiliated = string> = Omit<\n  z.infer<typeof affiliationRecordSchema>,\n  \"params\"\n> & { params: AffiliatedCommissionParams<Affiliated> | AppPaymentParams };\n\nexport type PopulatedAffiliationRecord = AffiliationRecord<{\n  _id: User[\"_id\"];\n  name: User[\"name\"];\n}>;\n"],"names":[],"mappings":";;AACA,OAAO,EAAE,eAAe,EAAE,MAAM,4BAA4B,CAAC;AAE7D,OAAO,CAAC,MAAM,KAAK,CAAC;AAEpB,MAAM,CAAC,MAAM,2BAA2B,GAAG;IACzC,qBAAqB,EAAE,sBAAsB;IAC7C,WAAW,EAAE,YAAY;CACjB,CAAC;AAIX,MAAM,gCAAgC,GAAG,CAAC,CAAC,MAAM,CAAC;IAChD,UAAU,EAAE,CAAC,CAAC,OAAO,CAAC,2BAA2B,CAAC,qBAAqB,CAAC;IACxE,UAAU,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,WAAW,EAAE,MAAM,EAAE,CAAC;IAC7C,aAAa,EAAE,CAAC,CAAC,MAAM,EAAE;CAC1B,CAAC,CAAC;AAEH,MAAM,sBAAsB,GAAG,CAAC,CAAC,MAAM,CAAC;IACtC,UAAU,EAAE,CAAC,CAAC,OAAO,CAAC,2BAA2B,CAAC,WAAW,CAAC;CAC/D,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,2BAA2B,GAAG,CAAC,CAAC,MAAM,CAAC;IAClD,MAAM,EAAE,CAAC,CAAC,MAAM,EAAE;IAClB,YAAY,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,WAAW,EAAE,MAAM,EAAE,CAAC;IAC/C,MAAM,EAAE,CAAC,CAAC,kBAAkB,CAAC,YAAY,EAAE;QACzC,gCAAgC;QAChC,sBAAsB;KACvB,CAAC;CACH,CAAC,CAAC;AAIH,MAAM,CAAC,MAAM,uBAAuB,GAClC,2BAA2B,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC","debug_id":"e8dafe2e-8ea8-56c7-8424-ed74170a9645"}