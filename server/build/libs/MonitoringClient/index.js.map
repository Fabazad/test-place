{"version":3,"file":"index.js","sources":["libs/MonitoringClient/index.ts"],"sourceRoot":"/","sourcesContent":["import { configs } from \"@/configs.js\";\nimport { createSingletonGetter } from \"@/utils/singleton.js\";\nimport * as Sentry from \"@sentry/node\";\nimport { nodeProfilingIntegration } from \"@sentry/profiling-node\";\nimport { LogLevel, MonitoringClient } from \"./type.js\";\n\nconst createMonitoringClient = (): MonitoringClient => {\n  return {\n    init: () => {\n      Sentry.init({\n        dsn: configs.SENTRY_DSN,\n        integrations: [nodeProfilingIntegration()],\n        // Tracing\n        tracesSampleRate: 1.0, //  Capture 100% of the transactions\n\n        // Set sampling rate for profiling - this is relative to tracesSampleRate\n        profilesSampleRate: 1.0,\n      });\n    },\n    sendEvent: async ({ eventName, data, level }) => {\n      if (level === LogLevel.ERROR) {\n        Sentry.captureMessage(eventName, { level: \"error\", extra: data });\n      } else if (level === LogLevel.WARNING) {\n        Sentry.captureMessage(eventName, { level: \"warning\", extra: data });\n      } else if (level === LogLevel.INFO) {\n        Sentry.captureMessage(eventName, { level: \"info\", extra: data });\n      } else {\n        Sentry.captureMessage(eventName, { level: \"debug\", extra: data });\n      }\n    },\n    setupErrorHandler: ({ app }) => {\n      Sentry.setupExpressErrorHandler(app);\n    },\n  };\n};\n\nexport const getMonitoringClient = createSingletonGetter(createMonitoringClient);\n"],"names":[],"mappings":";;AAAA,OAAO,EAAE,OAAO,EAAE,MAAM,cAAc,CAAC;AACvC,OAAO,EAAE,qBAAqB,EAAE,MAAM,sBAAsB,CAAC;AAC7D,OAAO,KAAK,MAAM,MAAM,cAAc,CAAC;AACvC,OAAO,EAAE,wBAAwB,EAAE,MAAM,wBAAwB,CAAC;AAClE,OAAO,EAAE,QAAQ,EAAoB,MAAM,WAAW,CAAC;AAEvD,MAAM,sBAAsB,GAAG,GAAqB,EAAE;IACpD,OAAO;QACL,IAAI,EAAE,GAAG,EAAE;YACT,MAAM,CAAC,IAAI,CAAC;gBACV,GAAG,EAAE,OAAO,CAAC,UAAU;gBACvB,YAAY,EAAE,CAAC,wBAAwB,EAAE,CAAC;gBAC1C,UAAU;gBACV,gBAAgB,EAAE,GAAG,EAAE,oCAAoC;gBAE3D,yEAAyE;gBACzE,kBAAkB,EAAE,GAAG;aACxB,CAAC,CAAC;QACL,CAAC;QACD,SAAS,EAAE,KAAK,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE;YAC9C,IAAI,KAAK,KAAK,QAAQ,CAAC,KAAK,EAAE,CAAC;gBAC7B,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;YACpE,CAAC;iBAAM,IAAI,KAAK,KAAK,QAAQ,CAAC,OAAO,EAAE,CAAC;gBACtC,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;YACtE,CAAC;iBAAM,IAAI,KAAK,KAAK,QAAQ,CAAC,IAAI,EAAE,CAAC;gBACnC,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;YACnE,CAAC;iBAAM,CAAC;gBACN,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;YACpE,CAAC;QACH,CAAC;QACD,iBAAiB,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE;YAC7B,MAAM,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAC;QACvC,CAAC;KACF,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,mBAAmB,GAAG,qBAAqB,CAAC,sBAAsB,CAAC,CAAC","debug_id":"e2f0ba3f-404c-5010-b081-38c2be7a4ccc"}