{"version":3,"file":"getPrice.js","sources":["libs/AmazonClient/paapiProductHelpers/getPrice.ts"],"sourceRoot":"/","sourcesContent":["import { Item } from \"paapi5-typescript-sdk\";\nimport { getAmazonProductDetails } from \"../scrapperProductHelpers/index.js\";\n\nexport const getPrice = async (\n  item: Item,\n  amazonMerchantId?: string\n): Promise<{\n  amount: number;\n  isPrime: boolean;\n  seller?: { name: string; url: string };\n} | null> => {\n  if (amazonMerchantId) {\n    const result = await getAmazonProductDetails({ asin: item.ASIN, amazonMerchantId });\n    if (!result.success) return null;\n    return {\n      amount: result.data.price,\n      isPrime: result.data.isPrime,\n      seller: result.data.seller,\n    };\n  }\n\n  if (!item.Offers?.Listings?.[0]) return null;\n\n  const merchantListing = item.Offers.Listings[0];\n\n  if (!merchantListing || !merchantListing.Price?.Amount) return null;\n\n  const seller = merchantListing.MerchantInfo\n    ? {\n        name: merchantListing.MerchantInfo.Name,\n        url: `https://www.amazon.fr/sp?ie=UTF8&seller=${merchantListing.MerchantInfo.Id}`,\n      }\n    : undefined;\n\n  return {\n    amount: merchantListing.Price.Amount,\n    isPrime: merchantListing.ProgramEligibility?.IsPrimeExclusive || false,\n    seller,\n  };\n};\n"],"names":[],"mappings":";;AACA,OAAO,EAAE,uBAAuB,EAAE,MAAM,oCAAoC,CAAC;AAE7E,MAAM,CAAC,MAAM,QAAQ,GAAG,KAAK,EAC3B,IAAU,EACV,gBAAyB,EAKjB,EAAE;IACV,IAAI,gBAAgB,EAAE,CAAC;QACrB,MAAM,MAAM,GAAG,MAAM,uBAAuB,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,gBAAgB,EAAE,CAAC,CAAC;QACpF,IAAI,CAAC,MAAM,CAAC,OAAO;YAAE,OAAO,IAAI,CAAC;QACjC,OAAO;YACL,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,KAAK;YACzB,OAAO,EAAE,MAAM,CAAC,IAAI,CAAC,OAAO;YAC5B,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,MAAM;SAC3B,CAAC;IACJ,CAAC;IAED,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QAAE,OAAO,IAAI,CAAC;IAE7C,MAAM,eAAe,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;IAEhD,IAAI,CAAC,eAAe,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,MAAM;QAAE,OAAO,IAAI,CAAC;IAEpE,MAAM,MAAM,GAAG,eAAe,CAAC,YAAY;QACzC,CAAC,CAAC;YACE,IAAI,EAAE,eAAe,CAAC,YAAY,CAAC,IAAI;YACvC,GAAG,EAAE,2CAA2C,eAAe,CAAC,YAAY,CAAC,EAAE,EAAE;SAClF;QACH,CAAC,CAAC,SAAS,CAAC;IAEd,OAAO;QACL,MAAM,EAAE,eAAe,CAAC,KAAK,CAAC,MAAM;QACpC,OAAO,EAAE,eAAe,CAAC,kBAAkB,EAAE,gBAAgB,IAAI,KAAK;QACtE,MAAM;KACP,CAAC;AACJ,CAAC,CAAC","debug_id":"ef87a278-84c1-5ab3-95c0-1945774d7ff5"}